This is the master code
